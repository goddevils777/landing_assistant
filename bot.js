const TelegramBot = require('node-telegram-bot-api');
require('dotenv').config();

const bot = new TelegramBot(process.env.TELEGRAM_BOT_TOKEN, { polling: true });

// Ð¥Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ð¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ð¹
const users = new Map();

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ /start
bot.onText(/\/start/, (msg) => {
    const chatId = msg.chat.id;
    const userId = msg.from.id;

    // ÐŸÑ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ñ Ð²Ñ‹Ð±Ð¾Ñ€Ð¾Ð¼
    const keyboard = {
        reply_markup: {
            inline_keyboard: [
                [
                    {
                        text: 'ðŸ“š Ð‘ÐµÐ·ÐºÐ¾ÑˆÑ‚Ð¾Ð²Ð½Ð¸Ð¹ ÑƒÑ€Ð¾Ðº',
                        callback_data: 'free_lesson'
                    }
                ],
                [
                    {
                        text: 'ðŸ‘‹ ÐŸÑ€Ð¾ Ð¼ÐµÐ½Ðµ Ñ‚Ð° Ð¿Ñ–Ð´Ð±Ñ–Ñ€ Ð°ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð°',
                        callback_data: 'about_me'
                    }
                ]
            ]
        }
    };

    bot.sendMessage(chatId, `ÐŸÑ€Ð¸Ð²Ñ–Ñ‚! ðŸ‘‹ 
    
Ð›Ð°ÑÐºÐ°Ð²Ð¾ Ð¿Ñ€Ð¾ÑÐ¸Ð¼Ð¾ Ð½Ð° ÐºÑƒÑ€Ñ "ÐÑÐ¸ÑÑ‚ÐµÐ½Ñ‚ ÐšÐµÑ€Ñ–Ð²Ð½Ð¸ÐºÐ°" Ð²Ñ–Ð´ Ð”Ð°Ñ€Ñ–Ñ— ÐšÐ»Ð¸Ð¼ÐµÐ½ÐºÐ¾!

ÐžÐ±ÐµÑ€Ñ–Ñ‚ÑŒ Ñ‰Ð¾ Ð²Ð°Ñ Ñ†Ñ–ÐºÐ°Ð²Ð¸Ñ‚ÑŒ:`, keyboard);

    users.set(userId, { chatId: chatId, state: 'start' });
});

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ð¹ ÐºÐ½Ð¾Ð¿Ð¾Ðº
bot.on('callback_query', (query) => {
    const chatId = query.message.chat.id;
    const userId = query.from.id;
    const data = query.data;

    bot.answerCallbackQuery(query.id);

    if (data === 'free_lesson') {
        startFreeLessonScenario(chatId, userId);
    } else if (data === 'about_me') {
        startAboutMeScenario(chatId, userId);
    } else if (data === 'ready_assistant') {
        sendPaymentOffer(chatId, userId);
    }
});

// Ð¡Ñ†ÐµÐ½Ð°Ñ€Ð¸Ð¹ Ð±ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾Ð³Ð¾ ÑƒÑ€Ð¾ÐºÐ°
function startFreeLessonScenario(chatId, userId) {
    users.set(userId, { chatId: chatId, state: 'lesson' });

    // 1. Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº ÑƒÑ€Ð¾ÐºÐ°
    setTimeout(() => {
        bot.sendMessage(chatId, 'ðŸ“š *Ð£Ñ€Ð¾Ðº 1: Ð Ð¾Ð»ÑŒ Ð°ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð° Ð² Ð±Ñ–Ð·Ð½ÐµÑÑ–*', { parse_mode: 'Markdown' });
    }, 1000);

    // 2. Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð°Ð½Ð¸Ðµ ÑƒÑ€Ð¾ÐºÐ°
    setTimeout(() => {
        const lessonContent = `ðŸ”¹ *Ð£Ð¿Ñ€Ð°Ð²Ð»ÑÑ” Ñ‡Ð°ÑÐ¾Ð¼* â€” Ð¿Ð»Ð°Ð½ÑƒÑ” Ð·ÑƒÑÑ‚Ñ€Ñ–Ñ‡Ñ–, ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»ÑŽÑ” Ð´ÐµÐ´Ð»Ð°Ð¹Ð½Ð¸
ðŸ”¹ *Ð¤Ñ–Ð»ÑŒÑ‚Ñ€ÑƒÑ” Ñ–Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–ÑŽ* â€” Ð²Ð¸Ð·Ð½Ð°Ñ‡Ð°Ñ” Ð¿Ñ€Ñ–Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ð¸, Ð³Ð¾Ñ‚ÑƒÑ” Ñ€ÐµÐ·ÑŽÐ¼Ðµ  
ðŸ”¹ *ÐŸÑ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÑÑ” ÐºÐ¾Ð¼Ð¿Ð°Ð½Ñ–ÑŽ* â€” Ð²ÐµÐ´Ðµ Ð¿ÐµÑ€ÐµÐ³Ð¾Ð²Ð¾Ñ€Ð¸ Ð²Ñ–Ð´ Ñ–Ð¼ÐµÐ½Ñ– ÐºÐµÑ€Ñ–Ð²Ð½Ð¸ÐºÐ°
ðŸ”¹ *Ð’Ð¸Ñ€Ñ–ÑˆÑƒÑ” Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð¸* â€” Ð·Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ Ñ€Ñ–ÑˆÐµÐ½Ð½Ñ Ð´Ð¾ Ñ‚Ð¾Ð³Ð¾, ÑÐº Ð²Ð¾Ð½Ð¸ ÑÑ‚Ð°Ð½ÑƒÑ‚ÑŒ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡Ð½Ð¸Ð¼Ð¸

ðŸ’¡ *ÐŸÑ€Ð°ÐºÑ‚Ð¸Ñ‡Ð½Ðµ Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ:*
Ð¡ÐºÐ»Ð°Ð´Ñ–Ñ‚ÑŒ Ñ–Ð´ÐµÐ°Ð»ÑŒÐ½Ð¸Ð¹ Ñ€Ð¾Ð·ÐºÐ»Ð°Ð´ Ð´Ð½Ñ Ð´Ð»Ñ ÐºÐµÑ€Ñ–Ð²Ð½Ð¸ÐºÐ° IT-ÐºÐ¾Ð¼Ð¿Ð°Ð½Ñ–Ñ—, Ð²Ñ€Ð°Ñ…Ð¾Ð²ÑƒÑŽÑ‡Ð¸:
- 3 Ð²Ð°Ð¶Ð»Ð¸Ð²Ñ– Ð·ÑƒÑÑ‚Ñ€Ñ–Ñ‡Ñ–  
- Ð§Ð°Ñ Ð½Ð° ÐµÐ»ÐµÐºÑ‚Ñ€Ð¾Ð½Ð½Ñƒ Ð¿Ð¾ÑˆÑ‚Ñƒ
- ÐžÐ±Ñ–Ð´Ð½ÑŽ Ð¿ÐµÑ€ÐµÑ€Ð²Ñƒ
- Ð§Ð°Ñ Ð´Ð»Ñ ÑÑ‚Ñ€Ð°Ñ‚ÐµÐ³Ñ–Ñ‡Ð½Ð¾Ð³Ð¾ Ð¿Ð»Ð°Ð½ÑƒÐ²Ð°Ð½Ð½Ñ`;

        bot.sendMessage(chatId, lessonContent, { parse_mode: 'Markdown' });
    }, 2000);

    // 3. Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¾ Ð²Ð¸Ð´ÐµÐ¾
    setTimeout(() => {
        bot.sendMessage(chatId, 'ðŸ“¹ *Ð’Ñ–Ð´Ð¿Ñ€Ð°Ð²Ð»ÑÑ”Ð¼Ð¾ Ð²Ñ–Ð´ÐµÐ¾ ÑƒÑ€Ð¾Ðº*', { parse_mode: 'Markdown' });
    }, 3000);

    // 4. Ð’Ð¸Ð´ÐµÐ¾
    setTimeout(() => {
        bot.sendVideo(chatId, './video/1less.mp4', {
            caption: ''
        }).catch(error => {
            console.error('Error sending video:', error);
            bot.sendMessage(chatId, 'ðŸ“¹ Ð’Ñ–Ð´ÐµÐ¾ ÑƒÑ€Ð¾Ðº Ð±ÑƒÐ´Ðµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¸Ð¹ Ð½Ð°Ð¹Ð±Ð»Ð¸Ð¶Ñ‡Ð¸Ð¼ Ñ‡Ð°ÑÐ¾Ð¼');
        });
    }, 4000);

    // 5. ÐšÐ½Ð¾Ð¿ÐºÐ° "Ð“Ð¾Ñ‚Ð¾Ð²Ñ– ÑÑ‚Ð°Ñ‚Ð¸ Ð°ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð¾Ð¼"
    setTimeout(() => {
        const readyKeyboard = {
            reply_markup: {
                inline_keyboard: [
                    [
                        {
                            text: 'ðŸŽ“ Ð“Ð¾Ñ‚Ð¾Ð²Ñ– ÑÑ‚Ð°Ñ‚Ð¸ Ð¿Ñ€Ð¾Ñ„ÐµÑÑ–Ð¹Ð½Ð¸Ð¼ Ð°ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð¾Ð¼?',
                            callback_data: 'ready_assistant'
                        }
                    ]
                ]
            }
        };

        bot.sendMessage(chatId, 'Ð¡Ð¿Ð¾Ð´Ð¾Ð±Ð°Ð²ÑÑ ÑƒÑ€Ð¾Ðº?', readyKeyboard);
    }, 5000);
}

// Ð¡Ñ†ÐµÐ½Ð°Ñ€Ð¸Ð¹ "ÐŸÑ€Ð¾ Ð¼ÐµÐ½Ðµ"
function startAboutMeScenario(chatId, userId) {
    users.set(userId, { chatId: chatId, state: 'about_me' });

    // 1. ÐŸÑ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ðµ
    bot.sendMessage(chatId, 'Ð’Ñ–Ñ‚Ð°Ð½Ð½Ñ! ðŸ‘‹');

    // 2. Ð’Ð¸Ð´ÐµÐ¾ ÐºÑ€ÑƒÐ¶Ð¾Ðº
    setTimeout(() => {
        bot.sendVideoNote(chatId, './video/hello.mp4').catch(error => {
            console.error('Error sending video note:', error);
            bot.sendMessage(chatId, 'ðŸ“¹ Ð’Ñ–Ð´ÐµÐ¾ Ð¿Ñ€Ð¸Ð²Ñ–Ñ‚Ð°Ð½Ð½Ñ Ð±ÑƒÐ´Ðµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ðµ Ð½Ð°Ð¹Ð±Ð»Ð¸Ð¶Ñ‡Ð¸Ð¼ Ñ‡Ð°ÑÐ¾Ð¼');
        });
    }, 1000);

    // 3. Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾Ð±Ð¾ Ð¼Ð½Ðµ
    setTimeout(() => {
        bot.sendMessage(chatId, `*ÐšÐ»Ð¸Ð¼ÐµÐ½ÐºÐ¾ Ð”Ð°Ñ€Ñ–Ñ* ðŸ‘©â€ðŸ’¼

ÐœÐ¾Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð° Ð¼Ð°Ñ” Ð´Ð¾ÑÐ²Ñ–Ð´ Ð² Ð¿Ñ–Ð´Ð±Ð¾Ñ€Ñ– ÐºÑ€Ð°Ñ‰Ð¸Ñ… Ð°ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ñ–Ð² Ð²Ð¶Ðµ 5 Ñ€Ð¾ÐºÑ–Ð² ðŸ”`, { parse_mode: 'Markdown' });
    }, 2000);

    // 4. Ð¤Ð¾Ñ‚Ð¾ Ð¸ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ
    setTimeout(() => {
        // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ñ„Ð¾Ñ‚Ð¾ (Ð·Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿ÑƒÑ‚ÑŒ Ðº Ñ„Ð¾Ñ‚Ð¾)
        bot.sendPhoto(chatId, './images/people.png', {
            caption: '*Ð”ÐµÐ»ÐµÐ³ÑƒÐ¹Ñ‚Ðµ ÑÐ²Ð¾Ñ— Ð·Ð°Ð´Ð°Ñ‡Ñ– ÐºÑ€Ð°Ñ‰Ð¾Ð¼Ñƒ Ð°ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ñƒ Ñ‚Ð° Ñ€Ð¾Ð·Ð²Ð¸Ð²Ð°Ð¹Ñ‚Ðµ Ð’Ð°Ñˆ Ð±Ñ–Ð·Ð½ÐµÑ Ð±ÐµÐ· Ð·Ð°Ð¹Ð²Ð¸Ñ… Ñ‚ÑƒÑ€Ð±Ð¾Ñ‚!* ðŸš€',
            parse_mode: 'Markdown'
        }).catch(error => {
            console.error('Error sending photo:', error);
            bot.sendMessage(chatId, '*Ð”ÐµÐ»ÐµÐ³ÑƒÐ¹Ñ‚Ðµ ÑÐ²Ð¾Ñ— Ð·Ð°Ð´Ð°Ñ‡Ñ– ÐºÑ€Ð°Ñ‰Ð¾Ð¼Ñƒ Ð°ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ñƒ Ñ‚Ð° Ñ€Ð¾Ð·Ð²Ð¸Ð²Ð°Ð¹Ñ‚Ðµ Ð’Ð°Ñˆ Ð±Ñ–Ð·Ð½ÐµÑ Ð±ÐµÐ· Ð·Ð°Ð¹Ð²Ð¸Ñ… Ñ‚ÑƒÑ€Ð±Ð¾Ñ‚!* ðŸš€', { parse_mode: 'Markdown' });
        });
    }, 3000);

    // 5. Ð¤Ð¾Ñ€Ð¼Ð° ÑÐ²ÑÐ·Ð¸
    setTimeout(() => {
        bot.sendMessage(chatId, `ðŸ“ *Ð¤Ð¾Ñ€Ð¼Ð° Ð·Ð²'ÑÐ·ÐºÑƒ*

Ð—Ð°Ð»Ð¸ÑˆÑ‚Ðµ ÑÐ²Ð¾Ñ— ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¸ Ñ– Ð¼Ð¸ Ð·Ð²'ÑÐ¶ÐµÐ¼Ð¾ÑÑŒ Ð· Ð’Ð°Ð¼Ð¸:

ÐÐ°Ð¿Ð¸ÑˆÑ–Ñ‚ÑŒ Ñƒ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ñ–:
ðŸ‘¤ Ð†Ð¼'Ñ:
ðŸ“± Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½/Telegram:
ðŸ’¬ Ð¯Ðº Ð·Ñ€ÑƒÑ‡Ð½Ñ–ÑˆÐµ Ð·Ð²'ÑÐ·Ð°Ñ‚Ð¸ÑÑŒ:`, { parse_mode: 'Markdown' });
    }, 4000);
}

// ÐŸÑ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð¾Ð± Ð¾Ð¿Ð»Ð°Ñ‚Ðµ
const paymentOffer = `ðŸŽ“ *Ð“Ð¾Ñ‚Ð¾Ð²Ñ– ÑÑ‚Ð°Ñ‚Ð¸ Ð¿Ñ€Ð¾Ñ„ÐµÑÑ–Ð¹Ð½Ð¸Ð¼ Ð°ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð¾Ð¼?*

ÐžÐ±ÐµÑ€Ñ–Ñ‚ÑŒ Ð½Ð°Ð¹ÐºÑ€Ð°Ñ‰Ð¸Ð¹ Ð²Ð°Ñ€Ñ–Ð°Ð½Ñ‚ Ð´Ð»Ñ ÑÐµÐ±Ðµ:

ðŸ“š *ÐšÐ£Ð Ð¡ "ÐÐ¡Ð˜Ð¡Ð¢Ð•ÐÐ¢ ÐšÐ•Ð Ð†Ð’ÐÐ˜ÐšÐ"* - 250$
- 7 Ð¼Ð¾Ð´ÑƒÐ»Ñ–Ð² Ð¿Ñ€Ð¾Ñ„ÐµÑÑ–Ð¹Ð½Ð¾Ñ— Ð¿Ñ–Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ¸
- Ð¡ÐµÑ€Ñ‚Ð¸Ñ„Ñ–ÐºÐ°Ñ‚ Ð¿Ñ€Ð¾ Ð¿Ñ€Ð¾Ñ…Ð¾Ð´Ð¶ÐµÐ½Ð½Ñ
- ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½Ñ– ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ñ–Ñ— Ð· Ð”Ð°Ñ€Ñ–Ñ”ÑŽ
- ÐŸÑ–Ð´Ñ‚Ñ€Ð¸Ð¼ÐºÐ° Ð¿Ñ€Ð¾Ñ‚ÑÐ³Ð¾Ð¼ 3 Ð¼Ñ–ÑÑÑ†Ñ–Ð²

ðŸŽ¯ *ÐŸÐ†Ð”Ð‘Ð†Ð  ÐÐ¡Ð˜Ð¡Ð¢Ð•ÐÐ¢Ð Ð— Ð“ÐÐ ÐÐÐ¢Ð†Ð„Ð®* - 350$
- Ð†Ð½Ð´Ð¸Ð²Ñ–Ð´ÑƒÐ°Ð»ÑŒÐ½Ð¸Ð¹ Ð²Ñ–Ð´Ð±Ñ–Ñ€ ÐºÐ°Ð½Ð´Ð¸Ð´Ð°Ñ‚Ñ–Ð²
- ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€ÐºÐ° Ð´Ð¾ÑÐ²Ñ–Ð´Ñƒ Ñ‚Ð° Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ñ–Ð¹
- Ð“Ð°Ñ€Ð°Ð½Ñ‚Ñ–Ñ Ð·Ð°Ð¼Ñ–Ð½Ð¸ Ð¿Ñ€Ð¾Ñ‚ÑÐ³Ð¾Ð¼ Ð¼Ñ–ÑÑÑ†Ñ
- Ð¡ÑƒÐ¿Ñ€Ð¾Ð²Ñ–Ð´ Ð½Ð° Ð¿ÐµÑ€ÑˆÑ– Ñ‚Ð¸Ð¶Ð½Ñ– Ñ€Ð¾Ð±Ð¾Ñ‚Ð¸

ðŸ’¼ *ÐšÐÐ 'Ð„Ð ÐÐ ÐšÐžÐÐ¡Ð£Ð›Ð¬Ð¢ÐÐ¦Ð†Ð¯* - 50$
- ÐÐ½Ð°Ð»Ñ–Ð· Ð²Ð°ÑˆÐ¾Ð³Ð¾ Ñ€ÐµÐ·ÑŽÐ¼Ðµ
- ÐŸÐ¾Ñ€Ð°Ð´Ð¸ Ñ‰Ð¾Ð´Ð¾ Ñ€Ð¾Ð·Ð²Ð¸Ñ‚ÐºÑƒ ÐºÐ°Ñ€'Ñ”Ñ€Ð¸
- ÐŸÐ»Ð°Ð½ÑƒÐ²Ð°Ð½Ð½Ñ Ð¿Ñ€Ð¾Ñ„ÐµÑÑ–Ð¹Ð½Ð¾Ð³Ð¾ Ð·Ñ€Ð¾ÑÑ‚Ð°Ð½Ð½Ñ
- Ð†Ð½Ð´Ð¸Ð²Ñ–Ð´ÑƒÐ°Ð»ÑŒÐ½Ð° ÑÑ‚Ñ€Ð°Ñ‚ÐµÐ³Ñ–Ñ Ð¿Ð¾ÑˆÑƒÐºÑƒ Ñ€Ð¾Ð±Ð¾Ñ‚Ð¸

ðŸ’° *Ð£ÑÑ– Ñ†Ñ–Ð½Ð¸ Ñ„Ñ–ÐºÑÐ¾Ð²Ð°Ð½Ñ–, Ð±ÐµÐ· Ð¿Ñ€Ð¸Ñ…Ð¾Ð²Ð°Ð½Ð¸Ñ… Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ñ–Ð²*`;

function sendPaymentOffer(chatId, userId) {
    const keyboard = {
        inline_keyboard: [
            [
                {
                    text: 'ðŸ“š ÐšÑƒÑ€Ñ - 250$',
                    url: 'https://revolut.me/dariiapcx7/usd250/ÐºÑƒÑ€Ñ-Ð°ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚-ÐºÐµÑ€Ñ–Ð²Ð½Ð¸ÐºÐ°'
                }
            ],
            [
                {
                    text: 'ðŸŽ¯ ÐŸÑ–Ð´Ð±Ñ–Ñ€ Ð°ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð° Ð· Ð³Ð°Ñ€Ð°Ð½Ñ‚Ñ–Ñ”ÑŽ - 350$',
                    url: 'https://revolut.me/dariiapcx7/usd350/Ð¿Ñ–Ð´Ð±Ñ–Ñ€-Ð°ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð°-Ð³Ð°Ñ€Ð°Ð½Ñ‚Ñ–Ñ'
                }
            ],
            [
                {
                    text: 'ðŸ’¼ ÐšÐ°Ñ€\'Ñ”Ñ€Ð½Ð° ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ñ–Ñ - 50$',
                    url: 'https://revolut.me/dariiapcx7/usd50/ÐºÐ°Ñ€Ñ”Ñ€Ð½Ð°-ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ñ–Ñ'
                }
            ],
            [
                {
                    text: 'ðŸ“ž Ð—Ð²\'ÑÐ·Ð°Ñ‚Ð¸ÑÑŒ Ð· Ð”Ð°Ñ€Ñ–Ñ”ÑŽ',
                    url: 'https://t.me/klymenkodariia'
                }
            ]
        ]
    };

    bot.sendMessage(chatId, paymentOffer, {
        parse_mode: 'Markdown',
        reply_markup: keyboard
    });
}

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
bot.on('message', (msg) => {
    const chatId = msg.chat.id;
    const userId = msg.from.id;

    // ÐŸÑ€Ð¾Ð¿ÑƒÑÐºÐ°ÐµÐ¼ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹
    if (msg.text && msg.text.startsWith('/')) return;

    const user = users.get(userId);

    if (user && user.state === 'lesson') {
        // ÐžÑ‚Ð²ÐµÑ‚ Ð½Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ð¾Ðµ Ð·Ð°Ð´Ð°Ð½Ð¸Ðµ Ð¸Ð· ÑƒÑ€Ð¾ÐºÐ°
        if (msg.text && msg.text.length > 50) {
            bot.sendMessage(chatId, `Ð”ÑÐºÑƒÑŽ Ð·Ð° Ð²Ð¸ÐºÐ¾Ð½Ð°Ð½Ð½Ñ Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ! ðŸ‘

Ð’Ð°Ñˆ Ð¿Ñ–Ð´Ñ…Ñ–Ð´ Ð´Ð¾ Ð¿Ð»Ð°Ð½ÑƒÐ²Ð°Ð½Ð½Ñ Ð¿Ð¾ÐºÐ°Ð·ÑƒÑ” Ñ€Ð¾Ð·ÑƒÐ¼Ñ–Ð½Ð½Ñ Ð¾ÑÐ½Ð¾Ð² Ñ€Ð¾Ð±Ð¾Ñ‚Ð¸ Ð°ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð°.

Ð©Ð¾Ð± Ð¾Ñ‚Ñ€Ð¸Ð¼Ð°Ñ‚Ð¸ Ð´ÐµÑ‚Ð°Ð»ÑŒÐ½Ð¸Ð¹ Ñ€Ð¾Ð·Ð±Ñ–Ñ€ Ð²Ð°ÑˆÐ¾Ð³Ð¾ Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ Ñ‚Ð° Ð¿Ñ€Ð¾Ð´Ð¾Ð²Ð¶Ð¸Ñ‚Ð¸ Ð½Ð°Ð²Ñ‡Ð°Ð½Ð½Ñ, Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´ÑŒÑ‚Ðµ Ð´Ð¾ Ð¿Ð¾Ð²Ð½Ð¾Ð³Ð¾ ÐºÑƒÑ€ÑÑƒ! ðŸš€`);
        }
    } else if (user && user.state === 'about_me') {
        // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ñ„Ð¾Ñ€Ð¼Ñ‹ ÑÐ²ÑÐ·Ð¸
        if (msg.text && msg.text.length > 10) {
            bot.sendMessage(chatId, `Ð”ÑÐºÑƒÑŽ Ð·Ð° ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¸! ðŸ“

ÐœÐ¸ Ð·Ð²'ÑÐ¶ÐµÐ¼Ð¾ÑÑŒ Ð· Ð’Ð°Ð¼Ð¸ Ð½Ð°Ð¹Ð±Ð»Ð¸Ð¶Ñ‡Ð¸Ð¼ Ñ‡Ð°ÑÐ¾Ð¼ Ð´Ð»Ñ Ð¾Ð±Ð³Ð¾Ð²Ð¾Ñ€ÐµÐ½Ð½Ñ Ð¿Ñ–Ð´Ð±Ð¾Ñ€Ñƒ Ñ–Ð´ÐµÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð°ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð° Ð´Ð»Ñ Ð’Ð°ÑˆÐ¾Ð³Ð¾ Ð±Ñ–Ð·Ð½ÐµÑÑƒ.

ÐžÑ‡Ñ–ÐºÑƒÐ¹Ñ‚Ðµ Ð´Ð·Ð²Ñ–Ð½Ð¾Ðº Ð¿Ñ€Ð¾Ñ‚ÑÐ³Ð¾Ð¼ 24 Ð³Ð¾Ð´Ð¸Ð½! ðŸ“ž`);

            // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð·Ð°ÑÐ²ÐºÑƒ Ð°Ð´Ð¼Ð¸Ð½Ñƒ
            const adminMessage = `ðŸ”” ÐÐžÐ’Ð Ð—ÐÐ¯Ð’ÐšÐ: ÐŸÐ†Ð”Ð‘Ð†Ð  ÐÐ¡Ð˜Ð¡Ð¢Ð•ÐÐ¢Ð

ðŸ‘¤ ÐšÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡: @${msg.from.username || 'Ð½ÐµÐ²Ñ–Ð´Ð¾Ð¼Ð¾'}
ðŸ†” ID: ${msg.from.id}
ðŸ“ ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¸:
${msg.text}

ðŸ•’ ${new Date().toLocaleString('uk-UA')}`;

            bot.sendMessage(process.env.TELEGRAM_CHAT_ID, adminMessage).catch(error => {
                console.error('Error sending to admin:', error);
            });

            console.log('ÐÐ¾Ð²Ð°Ñ Ð·Ð°ÑÐ²ÐºÐ° Ð½Ð° Ð¿Ð¾Ð´Ð±Ð¾Ñ€ Ð°ÑÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð° Ð°Ð´Ð¼Ð¸Ð½Ñƒ');
        }
    }
});

// Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð¿Ð¾ÑÑ‚Ð¾ÑÐ½Ð½Ð¾Ð³Ð¾ Ð¼ÐµÐ½ÑŽ
bot.setMyCommands([
    { command: 'start', description: 'ðŸ  Ð“Ð¾Ð»Ð¾Ð²Ð½Ðµ Ð¼ÐµÐ½ÑŽ' },
    { command: 'lesson', description: 'ðŸ“š Ð‘ÐµÐ·ÐºÐ¾ÑˆÑ‚Ð¾Ð²Ð½Ð¸Ð¹ ÑƒÑ€Ð¾Ðº' },
    { command: 'about', description: 'ðŸ‘‹ ÐŸÑ€Ð¾ Ð¼ÐµÐ½Ðµ Ñ‚Ð° Ð¿Ñ–Ð´Ð±Ñ–Ñ€' }
]);

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… ÐºÐ¾Ð¼Ð°Ð½Ð´
bot.onText(/\/lesson/, (msg) => {
    const chatId = msg.chat.id;
    const userId = msg.from.id;
    startFreeLessonScenario(chatId, userId);
});

bot.onText(/\/about/, (msg) => {
    const chatId = msg.chat.id;
    const userId = msg.from.id;
    startAboutMeScenario(chatId, userId);
});

console.log('ðŸ¤– Telegram bot started');